import{aw as C,r as u,N as p,h as x,q as k,C as j,_ as c,j as a,a as n,B as d,F as w,bC as M,S as W,aB as A,z as g,v as F,o as b}from"./main-chatty-months-shout.js";import{u as _}from"./usewebho-chatty-months-shout-688.js";import{F as m}from"./index-chatty-months-shout-455.js";import{M as N}from"./index-chatty-months-shout-585.js";import{I as D}from"./index-chatty-months-shout-289.js";import{h as E,d as I}from"./index-chatty-months-shout-664.js";import{T as L}from"./index-chatty-months-shout-83.js";import{D as q,P as v}from"./index-chatty-months-shout-617.js";import{L as y}from"./index-chatty-months-shout-629.js";import"./useclosa-chatty-months-shout-441.js";import"./usebreak-chatty-months-shout-719.js";import"./index-chatty-months-shout-969.js";import"./paginati-chatty-months-shout-250.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function S(){const e=C(),{messageApi:t}=u.useContext(p),{isPending:l,mutateAsync:s}=x({mutationFn:async i=>k(`webhooks/${i}/delete`),mutationKey:["delete_webhook"],onError:i=>{t==null||t.warning(i.data)},onSuccess:({data:i})=>{e.setQueryData(["webhooks","all","all"],o=>o&&{...o,data:o.data.filter(({id:r})=>r!==i)})}});return{deleteWebhook:s,isWebhookDeleting:l}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function P(){const e=C(),{messageApi:t}=u.useContext(p),{isPending:l,mutateAsync:s}=x({mutationFn:async({title:i,webhookId:o})=>k(`webhooks/${o}/update-title`,{title:i}),mutationKey:["update_webhook_title"],onError:i=>{typeof i.data=="string"&&(t==null||t.error(i.data))},onSuccess:({data:i})=>{e.setQueryData(["webhooks","all","all"],o=>o&&j(o,r=>{const h=r.data.findIndex(f=>f.id===i.id);h!==-1&&(r.data[h].title=i.title)})),t==null||t.success(c("Webhook updated successfully"))}});return{isUpdatingTitle:l,updateWebhookTitle:s}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function U({isOpen:e,onClose:t,webhook:l}){const[s]=m.useForm(),{isUpdatingTitle:i,updateWebhookTitle:o}=P();u.useEffect(()=>{e&&l&&s.setFieldsValue({webhookTitle:l.title})},[e,l,s]);const r=async f=>{await o({title:f.webhookTitle,webhookId:l.id}),t(),s.resetFields()},h=()=>{s.resetFields(),t()};return a(N,{destroyOnClose:!0,footer:!1,maskClosable:!1,onCancel:h,open:e,title:c("Edit Webhook"),width:500,children:n(m,{form:s,layout:"vertical",onFinish:r,children:[a(m.Item,{label:c("Title"),name:"webhookTitle",rules:[{message:c("Webhook title is required"),required:!0},{max:255,message:c("Webhook title cannot exceed 255 characters")}],children:a(D,{placeholder:c("Enter webhook title")})}),a(m.Item,{className:"mb-0",children:n("div",{className:"flex justify-end gap-2",children:[a(d,{onClick:h,children:c("Cancel")}),a(d,{htmlType:"submit",loading:i,type:"primary",children:c("Update")})]})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function $({webhook:e}){const[t,l]=u.useState(!1),s=()=>{l(!0)},i=()=>{l(!1)};return n(w,{children:[a(d,{"data-testid":"edit-webhook",icon:a(M,{}),onClick:s,title:c("Edit webhook")}),a(U,{isOpen:t,onClose:i,webhook:e})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Link:z,Text:T,Title:B}=L;var O={name:"f3vz0n",styles:"font-weight:500"};function oe(){const{isWebhookLoading:e,webhooks:t}=_(),{deleteWebhook:l}=S(),{messageApi:s}=u.useContext(p),i=async o=>{await l(o),s==null||s.success("Webhook deleted successfully")};return n("div",{className:"p-6",children:[a("div",{className:"mb-4 flex items-center gap-2",children:a(B,{className:"mb-0",level:3,children:c("Webhooks")})}),a(q,{style:{marginTop:6}}),a(y,{dataSource:t,itemLayout:"horizontal",loading:e,renderItem:o=>a(y.Item,{actions:[a(w,{children:n("div",{className:"space-x-2",children:[n(T,{className:"inline-flex flex-col text-right",type:"secondary",children:[a("span",{children:E(o.created_at,new Date)}),a("small",{children:I(`${g.DATE_FORMAT} | ${g.TIME_FORMAT}`,o.created_at)})]}),n("div",{className:"inline-flex w-80 justify-end space-x-2",children:[(o==null?void 0:o.flow_id)&&a(d,{href:`#/flows/details/${o.flow_id}`,icon:a(F,{}),iconPosition:"end",target:"_blank",children:c("Go to Flow")}),a($,{webhook:o}),a(v,{cancelText:c("No"),description:c("Are you sure to delete this webhook?"),icon:a(b,{color:"red"}),okText:c("Yes"),onConfirm:()=>i(o.id),title:c("Delete the webhook"),children:a(d,{icon:a(b,{})})},"delete")]})]})})],children:n(W,{direction:"vertical",size:0,children:[a(T,{css:O,children:o.title}),a(z,{className:"text-xs text-slate-500",copyable:{icon:[a(A,{},"copy-icon")]},href:o.url,children:o.url})]})})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};export{oe as default};

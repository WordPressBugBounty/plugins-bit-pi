import{au as C,r as u,N as p,g as x,q as k,_ as c,j as a,a as r,B as d,F as w,bx as j,S as M,aY as W,y as g,s as _,n as b}from"./main-salty-geckos-sort.js";import{u as F}from"./usewebho-688.js";import{c as A}from"./mutative-523.js";import{F as m}from"./index-325.js";import{M as N}from"./index-888.js";import{I as D}from"./index-40.js";import{P as E}from"./pro-feat-471.js";import{L as y,h as I,d as L}from"./index-455.js";import{T as P}from"./index-997.js";import{D as q,P as S}from"./index-705.js";import"./col-480.js";import"./useclosa-449.js";import"./usebreak-169.js";import"./index-882.js";import"./extendso-11.js";import"./paginati-916.js";import"./index-498.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function v(){const e=C(),{messageApi:t}=u.useContext(p),{isPending:l,mutateAsync:s}=x({mutationFn:async i=>k(`pro_webhooks/${i}/delete`),mutationKey:["delete_webhook"],onError:i=>{t==null||t.warning(i.data)},onSuccess:({data:i})=>{e.setQueryData(["webhooks","all","all"],o=>o&&{...o,data:o.data.filter(({id:n})=>n!==i)})}});return{deleteWebhook:s,isWebhookDeleting:l}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function U(){const e=C(),{messageApi:t}=u.useContext(p),{isPending:l,mutateAsync:s}=x({mutationFn:async({title:i,webhookId:o})=>k(`pro_webhooks/${o}/update-title`,{title:i}),mutationKey:["update_webhook_title"],onError:i=>{typeof i.data=="string"&&(t==null||t.error(i.data))},onSuccess:({data:i})=>{e.setQueryData(["webhooks","all","all"],o=>o&&A(o,n=>{const h=n.data.findIndex(f=>f.id===i.id);h!==-1&&(n.data[h].title=i.title)})),t==null||t.success(c("Webhook updated successfully"))}});return{isUpdatingTitle:l,updateWebhookTitle:s}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function $({isOpen:e,onClose:t,webhook:l}){const[s]=m.useForm(),{isUpdatingTitle:i,updateWebhookTitle:o}=U();u.useEffect(()=>{e&&l&&s.setFieldsValue({webhookTitle:l.title})},[e,l,s]);const n=async f=>{await o({title:f.webhookTitle,webhookId:l.id}),t(),s.resetFields()},h=()=>{s.resetFields(),t()};return a(N,{destroyOnClose:!0,footer:!1,maskClosable:!1,onCancel:h,open:e,title:c("Edit Webhook"),width:500,children:r(m,{form:s,layout:"vertical",onFinish:n,children:[a(m.Item,{label:c("Title"),name:"webhookTitle",rules:[{message:c("Webhook title is required"),required:!0},{max:255,message:c("Webhook title cannot exceed 255 characters")}],children:a(D,{placeholder:c("Enter webhook title")})}),a(m.Item,{className:"mb-0",children:r("div",{className:"flex justify-end gap-2",children:[a(d,{onClick:h,children:c("Cancel")}),a(d,{htmlType:"submit",loading:i,type:"primary",children:c("Update")})]})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function O({webhook:e}){const[t,l]=u.useState(!1),s=()=>{l(!0)},i=()=>{l(!1)};return r(w,{children:[a(d,{"data-testid":"edit-webhook",icon:a(j,{}),onClick:s,title:c("Edit webhook")}),a($,{isOpen:t,onClose:i,webhook:e})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Link:R,Text:T,Title:z}=P;var B={name:"f3vz0n",styles:"font-weight:500"};function re(){const{isWebhookLoading:e,webhooks:t}=F(),{deleteWebhook:l}=v(),{messageApi:s}=u.useContext(p),i=async o=>{await l(o),s==null||s.success("Webhook deleted successfully")};return r("div",{className:"p-6",children:[r("div",{className:"mb-4 flex items-center gap-2",children:[a(z,{className:"mb-0",level:3,children:c("Webhooks")}),a(E,{})]}),a(q,{style:{marginTop:6}}),a(y,{dataSource:t,itemLayout:"horizontal",loading:e,renderItem:o=>a(y.Item,{actions:[a(w,{children:r("div",{className:"space-x-2",children:[r(T,{className:"inline-flex flex-col text-right",type:"secondary",children:[a("span",{children:I(o.created_at,new Date)}),a("small",{children:L(`${g.DATE_FORMAT} | ${g.TIME_FORMAT}`,o.created_at)})]}),r("div",{className:"inline-flex w-80 justify-end space-x-2",children:[(o==null?void 0:o.flow_id)&&a(d,{href:`#/flows/details/${o.flow_id}`,icon:a(_,{}),iconPosition:"end",target:"_blank",children:c("Go to Flow")}),a(O,{webhook:o}),a(S,{cancelText:c("No"),description:c("Are you sure to delete this webhook?"),icon:a(b,{color:"red"}),okText:c("Yes"),onConfirm:()=>i(o.id),title:c("Delete the webhook"),children:a(d,{icon:a(b,{})})},"delete")]})]})})],children:r(M,{direction:"vertical",size:0,children:[a(T,{css:B,children:o.title}),a(R,{className:"text-xs text-slate-500",copyable:{icon:[a(W,{},"copy-icon")]},href:o.url,children:o.url})]})})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};export{re as default};

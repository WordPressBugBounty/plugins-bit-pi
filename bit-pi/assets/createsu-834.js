import{a4 as E,a5 as c}from"./_applist-869.js";import{_ as l}from"./main-salty-geckos-sort.js";import{s as u}from"./machine.-202.js";import{c as _,f as s,e as i,b as o}from"./mailchim-337.js";import"./lodash-621.js";import"./mutative-523.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(n,e){return this.cache.has(n)?this.cache.get(n):(this.cache.set(n,e),e)}};const N=E(({helpers:n})=>({states:{components:[_(n),{componentName:n.componentName.select,defaultValue:"add_a_member_to_an_audience",id:"select-module",label:l("Select Module"),onChange:"HANDLE_SELECT_MODULE",options:[{label:l("Add a member to an audience"),value:"add_a_member_to_an_audience"},{label:l("Add tag to a member"),value:"add_tag_to_a_member"},{label:l("Remove tag from a member"),value:"remove_tag_from_a_member"}],path:"selectModule",render:"IF_CONNECTION_SELECTED",value:"add_a_member_to_an_audience"},{allowClear:!0,componentName:n.componentName.select,id:"select-audience",label:l("Select Audience"),onChange:"HANDLE_SELECT_AUDIENCE",onRefetch:"REFETCH_AUDIENCE_LIST",options:[],path:"selectAudience",render:"IF_CONNECTION_SELECTED",value:void 0},{componentName:n.componentName.select,id:"select-tag",label:l("Select Tag"),mode:"multiple",onChange:"HANDLE_SELECT_TAG",onRefetch:"REFETCH_TAG",options:[],path:"selectTags",render:"IF_AUDIENCE_SELECTED",showSearch:!0,value:void 0},{addItemButtonLabel:"Add Field",componentName:n.componentName.repeaterField,fieldsMetaData:[{componentName:n.componentName.select,label:l("Field"),name:"mailchimpField",options:[],showSearch:!0,style:{width:150},value:""},{componentName:n.componentName.mixInput,label:l("Value"),name:"value",value:[],wrapperClassName:"w-100"}],id:"field-map",label:l("Field Map"),labelActionIconName:"refresh-cw",labelActionOnClick:"REFETCH_AUDIENCE_FIELDS",labelActionText:l("Refetch Fields"),nonRemovableRows:[],onChange:"ON_CHANGE_FIELD_MAP_DATA",path:"fieldMap",render:"IF_AUDIENCE_SELECTED",value:[]},{componentName:n.componentName.select,defaultValue:"no",helperText:l("Add Address Field"),id:"add-address-field",label:l("Address Field"),onChange:"HANDLE_ADD_ADDRESS_FIELD",options:[{label:l("Yes"),value:"yes"},{label:l("No"),value:"no"}],path:"addAddressField",render:"IF_AUDIENCE_SELECTED",value:"no"},{addItemButtonLabel:"Add Field",componentName:n.componentName.repeaterField,fieldsMetaData:[{componentName:n.componentName.select,label:l("Field"),name:"mailchimpAddressField",options:[{label:l("Address 1"),value:"addr1"},{label:l("Address 2"),value:"addr2"},{label:l("City"),value:"city"},{label:l("Zip"),value:"zip"},{label:l("State"),value:"state"},{label:l("Country"),value:"country"}],showSearch:!0,style:{width:150},value:""},{componentName:n.componentName.mixInput,label:l("Value"),name:"value",value:[],wrapperClassName:"w-100"}],id:"address-field-map",label:l("Address Field Map"),nonRemovableRows:[0,1,2,3],onChange:"ON_CHANGE_ADDRESS_FIELD_MAP_DATA",path:"addressFieldMap",render:"IF_ADD_ADDRESS_SELECTED",value:[[{disabled:!0,name:"mailchimpAddressField",value:"addr1"},{name:"value",value:[]}],[{disabled:!0,name:"mailchimpAddressField",value:"city"},{name:"value",value:[]}],[{disabled:!0,name:"mailchimpAddressField",value:"zip"},{name:"value",value:[]}],[{disabled:!0,name:"mailchimpAddressField",value:"state"},{name:"value",value:[]}]]},{componentName:n.componentName.select,defaultValue:"no",helperText:l("Add Double Opt-in"),id:"double-opt-in",label:l("Double Opt-in"),onChange:"HANDLE_ADD_DOUBLE_OPT_IN",options:[{label:l("Yes"),value:"yes"},{label:l("No"),value:"no"}],path:"addDoubleOptIn",render:"IF_AUDIENCE_SELECTED",value:"no"},{componentName:n.componentName.select,defaultValue:"no",helperText:l("Update Responses if the Subscriber is exist?"),id:"update-subscriber",label:l("Update Subscriber"),onChange:"HANDLE_UPDATE_SUBSCRIBER",options:[{label:l("Yes"),value:"yes"},{label:l("No"),value:"no"}],path:"updateSubscriber",render:"IF_AUDIENCE_SELECTED",value:"no"}]},actions:{CONNECTION_ADD_CHANGE:({$:e,e:a})=>{e.setThisComponent(t=>{var m;if(e.util.isConnectionComponent(t))for(const d of t.connectionsTypes)d.type==="oauth2"&&((m=d.authCodeEndpoint)!=null&&m.queryParams&&(d.authCodeEndpoint.queryParams.client_id=a.clientId),d.tokenEndpoint.bodyParams&&(d.tokenEndpoint.bodyParams.client_id=a.clientId,d.tokenEndpoint.bodyParams.client_secret=a.clientSecret))})},IF_ADD_ADDRESS_SELECTED:({$:e})=>{var a;return((a=e.getComponent("add-address-field"))==null?void 0:a.value)==="yes"},IF_AUDIENCE_SELECTED:({$:e})=>{var a;return c((a=e.getComponent("select-audience"))==null?void 0:a.value)},IF_CONNECTION_SELECTED:({$:e})=>{var a;return c((a=e.getComponent("connection-id"))==null?void 0:a.value)},REFETCH_AUDIENCE_LIST:async({$:e})=>{await s(e)},REFETCH_AUDIENCE_FIELDS:async({$:e})=>{await o(e)},REFETCH_TAG:async({$:e})=>{await i(e)},HANDLE_SELECT_MODULE:({$:e,e:a})=>{e.setThisComponent(t=>{t.value=a}),e.setDb(t=>{t.selectModule=a}),o(e)},HANDLE_SELECT_AUDIENCE:({$:e,e:a})=>{e.setThisComponent(t=>{t.value=a}),e.setDb(t=>{t.selectAudience=a}),i(e),o(e)},HANDLE_SELECT_TAG:({$:e,e:a})=>{e.setThisComponent(t=>{t.value=a}),e.setDb(t=>{t.selectTags=a})},ON_CHANGE_FIELD_MAP_DATA:({$:e,e:a})=>{e.setThisComponent(t=>{t.value=a}),e.setDb(t=>{t.fieldMap=a})},HANDLE_ADD_ADDRESS_FIELD:({$:e,e:a})=>{e.setThisComponent(t=>{t.value=a}),e.setDb(t=>{t.addAddressField=a})},ON_CHANGE_ADDRESS_FIELD_MAP_DATA:({$:e,e:a})=>{e.setThisComponent(t=>{t.value=a}),e.setDb(t=>{t.addressFieldMap=a})},HANDLE_ADD_DOUBLE_OPT_IN:({$:e,e:a})=>{e.setThisComponent(t=>{t.value=a}),e.setDb(t=>{t.addDoubleOptIn=a})},HANDLE_UPDATE_SUBSCRIBER:({$:e,e:a})=>{e.setThisComponent(t=>{t.value=a}),e.setDb(t=>{t.updateSubscriber=a})},ON_MACHINE_LOAD:async({$:e})=>{u(e,[{db:"connectionId",id:"connection-id"},{db:"selectModule",id:"select-module"},{db:"selectAudience",id:"select-audience"},{db:"selectTags",id:"select-tag"},{db:"fieldMap",id:"field-map"},{db:"addAddressField",id:"add-address-field"},{db:"addressFieldMap",id:"address-field-map"},{db:"addDoubleOptIn",id:"double-opt-in"},{db:"updateSubscriber",id:"update-subscriber"}]),await Promise.all([s(e),i(e),o(e)])},SET_CONNECTION:async({$:e,e:a})=>{e.setThisComponent(t=>{t.value=a}),e.setDb(t=>{t.connectionId=a}),await Promise.all([s(e),i(e),o(e)])}}}));export{N as default};

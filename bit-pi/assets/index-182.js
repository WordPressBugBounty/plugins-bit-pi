import{au as T,r as d,N as p,g as b,q as _,_ as s,j as a,a as l,B as m,F as j,bx as M,w as A,S as N,y as g,n as y}from"./main-kind-dots-behave.js";import{u as w}from"./useconne-89.js";import{G as v}from"./_applist-971.js";import{L as C,h as F,d as I}from"./index-608.js";import{c as D}from"./mutative-640.js";import{F as u}from"./index-472.js";import{M as E}from"./index-484.js";import{I as S}from"./index-584.js";import{u as q}from"./utilscss-712.js";import{T as L,S as $}from"./index-446.js";import{D as x,P as k}from"./index-64.js";import{A as P}from"./index-623.js";import"./lodash-177.js";import"./extendso-9.js";import"./usebreak-257.js";import"./paginati-403.js";import"./col-700.js";import"./useclosa-7.js";import"./index-814.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function U(){const e=T(),{messageApi:t}=d.useContext(p),{isPending:r,mutateAsync:i}=b({mutationFn:async o=>_(`connections/${o}/delete`),mutationKey:["delete_connection"],onError:o=>{t==null||t.warning(o.data)},onSuccess:({data:o})=>{e.setQueryData(["connections","all","all"],n=>n&&{...n,data:n.data.filter(({id:c})=>c!==o)})}});return{deleteConnection:i,isConnectionDeleting:r}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function B(){const e=T(),{messageApi:t}=d.useContext(p),{isPending:r,mutateAsync:i}=b({mutationFn:async({connectionId:o,connectionName:n})=>_(`connections/${o}/update`,{connection_name:n}),mutationKey:["update_connection"],onError:o=>{typeof o.data=="string"&&(t==null||t.error(o.data))},onSuccess:({data:o})=>{e.setQueryData(["connections","all","all"],n=>n&&D(n,c=>{const h=c.data.findIndex(f=>f.id===o.id);h!==-1&&(c.data[h].connection_name=o.connection_name)})),t==null||t.success(s("Connection updated successfully"))}});return{isConnectionUpdating:r,updateConnection:i}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function O({connection:e,isOpen:t,onClose:r}){const[i]=u.useForm(),{isConnectionUpdating:o,updateConnection:n}=B();d.useEffect(()=>{t&&e&&i.setFieldsValue({connectionName:e.connection_name})},[t,e,i]);const c=async f=>{await n({connectionId:e.id,connectionName:f.connectionName}),r(),i.resetFields()},h=()=>{i.resetFields(),r()};return a(E,{destroyOnClose:!0,footer:!1,maskClosable:!1,onCancel:h,open:t,title:s("Edit Connection Name"),width:500,children:l(u,{form:i,layout:"vertical",onFinish:c,children:[a(u.Item,{label:s("Connection Name"),name:"connectionName",rules:[{message:s("Connection name is required"),required:!0},{max:255,message:s("Connection name cannot exceed 255 characters")}],children:a(S,{placeholder:s("Enter connection name")})}),a(u.Item,{className:"mb-0",children:l("div",{className:"flex justify-end gap-2",children:[a(m,{onClick:h,children:s("Cancel")}),a(m,{htmlType:"submit",loading:o,type:"primary",children:s("Update")})]})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Q({connection:e}){const[t,r]=d.useState(!1),i=()=>{r(!0)},o=()=>{r(!1)};return l(j,{children:[a(m,{icon:a(M,{}),onClick:i,title:s("Edit connection")}),a(O,{connection:e,isOpen:t,onClose:o})]})}const R="_avatar_6vzbc_1",z={avatar:R};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const K=()=>({avatar:e=>q({bdr:`1px solid ${A(e,-100)}*`,bg:`${e}*`,h:"40px*",p:"6px*",w:"40px*"})});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:G,Title:V}=L;function me(){const{connections:e,isConnectionLoading:t}=w(),{deleteConnection:r}=U(),{messageApi:i}=d.useContext(p),o=async n=>{await r(n),i==null||i.success("Connection deleted successfully")};return l("div",{className:"p-6",children:[a(V,{level:3,children:s("Connections")}),a(x,{className:"mt-3"}),a(C,{dataSource:e,itemLayout:"horizontal",loading:t,renderItem:n=>{const c=v(n.app_slug);return a(C.Item,{actions:[a(j,{children:l("div",{className:"space-x-2",children:[l(G,{className:"inline-flex flex-col text-right",type:"secondary",children:[a("span",{children:F(n.created_at,new Date)}),a("small",{children:I(`${g.DATE_FORMAT} | ${g.TIME_FORMAT}`,n.created_at)})]}),l("div",{className:"inline-flex w-60 justify-end space-x-2",children:[a(Q,{connection:n}),a(k,{cancelText:s("No"),description:s("Are you sure to delete this connection?"),icon:a(y,{color:"red"}),okText:s("Yes"),onConfirm:()=>o(n.id),title:s("Delete the connection"),children:a(m,{icon:a(y,{}),title:s("Delete connection")})},"delete")]})]})})],children:a($,{active:!0,avatar:!0,loading:t,title:!1,children:a(C.Item.Meta,{avatar:a(P,{className:z.avatar,css:K().avatar(c==null?void 0:c.color),src:c==null?void 0:c.logoUrl}),description:l(N,{className:"text-xs",split:a(x,{type:"vertical"}),children:[a("span",{children:c==null?void 0:c.name}),n.account_name&&a("span",{children:n.account_name})]}),title:n.connection_name})})})}})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};export{me as default};

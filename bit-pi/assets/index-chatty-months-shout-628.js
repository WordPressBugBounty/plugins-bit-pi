import{aw as T,r as d,N as g,h as b,q as _,C as M,_ as s,j as a,a as l,B as m,F as j,bC as A,x as N,S as w,z as p,o as y}from"./main-chatty-months-shout.js";import{u as v}from"./useconne-chatty-months-shout-96.js";import{k as F}from"./_applist-chatty-months-shout-814.js";import{h as I,d as D}from"./index-chatty-months-shout-664.js";import{F as u}from"./index-chatty-months-shout-455.js";import{M as E}from"./index-chatty-months-shout-585.js";import{I as S}from"./index-chatty-months-shout-289.js";import{u as q}from"./utilscss-chatty-months-shout-874.js";import{T as L,S as k}from"./index-chatty-months-shout-83.js";import{D as x,P as $}from"./index-chatty-months-shout-617.js";import{L as C}from"./index-chatty-months-shout-629.js";import{A as P}from"./index-chatty-months-shout-235.js";import"./lodash-chatty-months-shout-731.js";import"./useclosa-chatty-months-shout-441.js";import"./usebreak-chatty-months-shout-719.js";import"./index-chatty-months-shout-969.js";import"./paginati-chatty-months-shout-250.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function U(){const e=T(),{messageApi:t}=d.useContext(g),{isPending:r,mutateAsync:i}=b({mutationFn:async o=>_(`connections/${o}/delete`),mutationKey:["delete_connection"],onError:o=>{t==null||t.warning(o.data)},onSuccess:({data:o})=>{e.setQueryData(["connections","all","all"],n=>n&&{...n,data:n.data.filter(({id:c})=>c!==o)})}});return{deleteConnection:i,isConnectionDeleting:r}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function B(){const e=T(),{messageApi:t}=d.useContext(g),{isPending:r,mutateAsync:i}=b({mutationFn:async({connectionId:o,connectionName:n})=>_(`connections/${o}/update`,{connection_name:n}),mutationKey:["update_connection"],onError:o=>{typeof o.data=="string"&&(t==null||t.error(o.data))},onSuccess:({data:o})=>{e.setQueryData(["connections","all","all"],n=>n&&M(n,c=>{const h=c.data.findIndex(f=>f.id===o.id);h!==-1&&(c.data[h].connection_name=o.connection_name)})),t==null||t.success(s("Connection updated successfully"))}});return{isConnectionUpdating:r,updateConnection:i}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function O({connection:e,isOpen:t,onClose:r}){const[i]=u.useForm(),{isConnectionUpdating:o,updateConnection:n}=B();d.useEffect(()=>{t&&e&&i.setFieldsValue({connectionName:e.connection_name})},[t,e,i]);const c=async f=>{await n({connectionId:e.id,connectionName:f.connectionName}),r(),i.resetFields()},h=()=>{i.resetFields(),r()};return a(E,{destroyOnClose:!0,footer:!1,maskClosable:!1,onCancel:h,open:t,title:s("Edit Connection Name"),width:500,children:l(u,{form:i,layout:"vertical",onFinish:c,children:[a(u.Item,{label:s("Connection Name"),name:"connectionName",rules:[{message:s("Connection name is required"),required:!0},{max:255,message:s("Connection name cannot exceed 255 characters")}],children:a(S,{placeholder:s("Enter connection name")})}),a(u.Item,{className:"mb-0",children:l("div",{className:"flex justify-end gap-2",children:[a(m,{onClick:h,children:s("Cancel")}),a(m,{htmlType:"submit",loading:o,type:"primary",children:s("Update")})]})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function z({connection:e}){const[t,r]=d.useState(!1),i=()=>{r(!0)},o=()=>{r(!1)};return l(j,{children:[a(m,{icon:a(A,{}),onClick:i,title:s("Edit connection")}),a(O,{connection:e,isOpen:t,onClose:o})]})}const Q="_avatar_6vzbc_1",R={avatar:Q};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const K=()=>({avatar:e=>q({bdr:`1px solid ${N(e,-100)}*`,bg:`${e}*`,h:"40px*",p:"6px*",w:"40px*"})});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:V,Title:Y}=L;function de(){const{connections:e,isConnectionLoading:t}=v(),{deleteConnection:r}=U(),{messageApi:i}=d.useContext(g),o=async n=>{await r(n),i==null||i.success("Connection deleted successfully")};return l("div",{className:"p-6",children:[a(Y,{level:3,children:s("Connections")}),a(x,{className:"mt-3"}),a(C,{dataSource:e,itemLayout:"horizontal",loading:t,renderItem:n=>{const c=F(n.app_slug);return a(C.Item,{actions:[a(j,{children:l("div",{className:"space-x-2",children:[l(V,{className:"inline-flex flex-col text-right",type:"secondary",children:[a("span",{children:I(n.created_at,new Date)}),a("small",{children:D(`${p.DATE_FORMAT} | ${p.TIME_FORMAT}`,n.created_at)})]}),l("div",{className:"inline-flex w-60 justify-end space-x-2",children:[a(z,{connection:n}),a($,{cancelText:s("No"),description:s("Are you sure to delete this connection?"),icon:a(y,{color:"red"}),okText:s("Yes"),onConfirm:()=>o(n.id),title:s("Delete the connection"),children:a(m,{icon:a(y,{}),title:s("Delete connection")})},"delete")]})]})})],children:a(k,{active:!0,avatar:!0,loading:t,title:!1,children:a(C.Item.Meta,{avatar:a(P,{className:R.avatar,css:K().avatar(c==null?void 0:c.color),src:c==null?void 0:c.logoUrl}),description:l(w,{className:"text-xs",split:a(x,{type:"vertical"}),children:[a("span",{children:c==null?void 0:c.name}),n.account_name&&a("span",{children:n.account_name})]}),title:n.connection_name})})})}})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};export{de as default};
